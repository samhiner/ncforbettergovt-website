<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-168970691-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

	 	gtag('config', 'UA-168970691-1');
	</script>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Take Action | NC for Better Government</title>
	<meta name="description" content="We are a non-partisan group of passionate volunteers who are advocating for good government policies in the North Carolina State Government through direct advocacy and informing communities." />
	<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700,900" rel="stylesheet" />
	<link href="default.css" rel="stylesheet" type="text/css" media="all" />
	<link href="fonts.css" rel="stylesheet" type="text/css" media="all" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://apis.google.com/js/api.js"></script>
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBgbG8AKNNa9_vmg1o5pM49HFLESg8rNoo&libraries=places"></script>
	<!--[if IE 6]><link href="default_ie6.css" rel="stylesheet" type="text/css" /><![endif]-->
</head>
<body>
<div id="logo">
	<a href='index'><img src='images/logo.png'></a>
</div>
<div id="header">
	<div id="menu" class="container">
		<ul>
			<li><a href="index">Home</a></li>
			<li><a href="issues" id='test'>Issues</a></li>
			<li class="current_page_item"><a href="takeaction">Take Action</a></li> <!--style='border: 2px solid #1f4a82; border-radius: 5px; background-color: #d6d6d6;'-->
			<li><a href="about">About Us</a></li>
			<li><a href="donate">Donate</a></li>
		</ul>
	</div>
</div>
<script src='tabs.js'></script>
<div class='article'>
	<h1>How to Make a Difference</h1>
	<p>Phone calls > Personalized emails > Template emails. You can also sign up to be a volunteer, and more regularly make phone calls. As a volunteer, if you want we will also help you coordinate meeting with your legislator on the issue and you will help spread the movement.</p>

	<a name='email'><h1>Send an Email</h1></a>
	<div>
		<div id='districtFinder'>
			<form autocomplete='off'><input type='text' id='address' autocomplete='off' placeholder='Address' style='width: 100%'></form>
			<button onclick='getDistricts()'>Find Your District</button>
		</div><br>
		<div id='petitionTemplate'>
			<p>Dear [State Legislator's Name],<br><br>

			My name is <span id='petitionName' data-placeholder='Your Name' onkeyup='updateSignature()' contenteditable required></span><span class='required'>*</span> and I am a constituent of yours and a supporter of NC for Better Government. <span id='petitionTitle' data-placeholder='Your Title' data-tip='List any positions/influence you have in your specific community. Community leaders sway legislators more.' contenteditable></span> After learning about lame-duck power grabs and their effects, I am concerned about the effects that continuing to let lame-duck power grabs happen could have on our democracy.<br><textarea id='petitionOtherInfo' style='width: 100%' placeholder='Why else does this strike a chord with you. Feel free to add a personal story/anecdote, but make sure to stay nice'></textarea><br> I think this needs to be addressed by our state legislature.

			Should you be elected to the NC General Assembly this November, I ask you to oppose lame-duck power grabs and support legislation to abolish them.<br><br>

			Sincerely,<br><br>

			<span id='petitionSignature' placeholder='Your Name' disabled></span></p>
		</div>
		<h1>Give Them A Call</h1>
		<div id='phoneInfo'>

		</div>

		<a name='join'><h1>Join Us</h1></a>
		<div></div>
	</div>
</div>
<script>

	//TODO do something for what it should default to before you type and make it look better.

	//placeholder for input parts of email form
	//this is from https://htmldom.dev/placeholder-for-a-contenteditable-element/
	const inputsList = document.querySelectorAll('#petitionTemplate span[contenteditable]');


	//TODO event listener to get rid of HTML formatting


	function updateSignature() {
		document.getElementById('petitionSignature').innerHTML = document.getElementById('petitionName').innerHTML;
		$('#hiddenWidthSizer').text($('#petitionSignature').val());
		$('#petitionSignature').width($('#hiddenWidthSizer').width() + 2);
	}

	//autocomplete while you are looking up your address
	var options = {
		bounds: new google.maps.LatLngBounds( //results in NC are prioritized
			new google.maps.LatLng(34,-84.25),
			new google.maps.LatLng(36.35,-75.5)
		),
		types: ['address']
	};
	var input = document.getElementById('address');
	var autocomplete = new google.maps.places.Autocomplete(input, options);

	//code taken from Google Civic Data API to get district from address
	function getDistricts() {
		gapi.client.setApiKey("AIzaSyBgbG8AKNNa9_vmg1o5pM49HFLESg8rNoo");
		return gapi.client.load("https://content.googleapis.com/discovery/v1/apis/civicinfo/v2/rest")
			.then(function() { console.log("GAPI client loaded for API"); getDistrictsAPICall(); },
				function(err) { reportError("Error loading GAPI client for API: " + JSON.stringify(err)); });
	}
	function getDistrictsAPICall() {
		return gapi.client.civicinfo.representatives.representativeInfoByAddress({
			"address": document.getElementById('address').value,
			"includeOffices": true,
			"levels": [
				"administrativeArea1"
			],
			"roles": [
				"legislatorLowerBody",
				"legislatorUpperBody"
			]
		}).then(function(response) {
			console.log("Response", response);
			if (response.result.normalizedInput.state == 'NC') {
				phone1 = response.result.officials[0].phones != undefined ? response.result.officials[0].phones[0] : 'Phone number not found.';
				phone2 = response.result.officials[1].phones != undefined ? response.result.officials[1].phones[0] : 'Phone number not found.';
				phoneInfo = response.result.officials[0].name + ': ' + phone1 + '<br>' + response.result.officials[1].name + ': ' + phone2
				document.getElementById('phoneInfo').innerHTML = phoneInfo
			} else {
				alert('Please enter an address in North Carolina.');
				document.getElementById('address').value = '';
			}
		},
		function(err) { reportError("Execute error:" + JSON.stringify(err)); });
	}
	gapi.load("client");
</script>
<div id="copyright" class="container">
	<ul class='contact'>
		<li><a href="comingsoon" class="icon icon-facebook"></a></li>
		<li><a href="https://www.instagram.com/ncforbettergovt/" class="icon icon-instagram"></a></li>
		<li><a href="comingsoon" class="icon icon-twitter"></a></li>
		<li><a href="comingsoon" class="icon icon-linkedin"></a></li>
		<li><a href="takeaction#mailinglist" class="icon icon-rss"></a></li>
	</ul>

	<p>Image Credit: <a href='https://commons.wikimedia.org/wiki/File:NC_Legislature.JPG'>NC General Assembly Building</a></p>
	
	<p>Adapted from <a href='https://templated.co/swarming'>Swarming</a> by <a href="https://templated.co" rel="nofollow">TEMPLATED</a> | Hosted on <a href='https://www.dreamhost.com/r.cgi?2475375'>Dreamhost</a></p>
</div>
</body>
</html>
